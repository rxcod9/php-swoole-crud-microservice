<?xml version="1.0"?>
<ruleset name="ProductionStrictStandard">
    <description>
        Strict production-ready PHP_CodeSniffer ruleset for PHP 8.4
        - PSR-12 style baseline
        - PHPCompatibility 8.4
        - Slevomat strict rules (types, modern PHP, imports)
        - Doctrine annotations
        - Optional Security sniffs
        - Skips vendor, build, node_modules
    </description>

    <file>./src</file>
    <file>./tests</file>

    <!-- Base standard -->
    <rule ref="PSR12"/>

    <!-- PHP Compatibility -->
    <config name="testVersion" value="8.4"/>
    <rule ref="PHPCompatibility">
        <exclude name="PHPCompatibility.Extensions.RemovedExtensions.mysql_DeprecatedRemoved"/>
        <exclude name="PHPCompatibility.FunctionUse.RemovedFunctions.eregDeprecatedRemoved"/>
    </rule>

    <!-- Slevomat: strict typing -->
    <rule ref="SlevomatCodingStandard.TypeHints.DeclareStrictTypes"/>
    <rule ref="SlevomatCodingStandard.TypeHints.ParameterTypeHint"/>
    <rule ref="SlevomatCodingStandard.TypeHints.ReturnTypeHint"/>
    <rule ref="SlevomatCodingStandard.TypeHints.PropertyTypeHint"/>
    <rule ref="SlevomatCodingStandard.TypeHints.NullableTypeForNullDefaultValue"/>
    <rule ref="SlevomatCodingStandard.Classes.ModernClassNameReference"/>
    <rule ref="SlevomatCodingStandard.Namespaces.AlphabeticallySortedUses"/>
    <rule ref="SlevomatCodingStandard.Namespaces.UnusedUses"/>
    <!-- <rule ref="SlevomatCodingStandard.Namespaces.FullyQualifiedClassNameInAnnotation"/> -->
    <rule ref="SlevomatCodingStandard.Classes.RequireSelfReference"/>

    <!-- Comments / Docblocks -->
    <rule ref="Squiz.Commenting.FunctionComment"/>
    <rule ref="Squiz.Commenting.ClassComment"/>
    <rule ref="Squiz.Commenting.FileComment"/>
    <rule ref="SlevomatCodingStandard.Commenting.DocCommentSpacing"/>
    <rule ref="SlevomatCodingStandard.Commenting.EmptyComment"/>

    <!-- Exclusions -->
    <exclude-pattern>.git/*</exclude-pattern>
    <exclude-pattern>.github/*</exclude-pattern>
    <exclude-pattern>.idea/*</exclude-pattern>
    <exclude-pattern>.vscode/*</exclude-pattern>
    <exclude-pattern>build/*</exclude-pattern>
    <exclude-pattern>vendor/*</exclude-pattern>

    <!-- CI-friendly settings -->
    <arg name="report" value="full"/>
    <arg name="extensions" value="php"/>
    <arg name="error-severity" value="1"/>
    <arg name="warning-severity" value="0"/>
    <arg name="parallel" value="4"/>
    <arg name="encoding" value="utf-8"/>
    <arg name="tab-width" value="4"/>
</ruleset>
